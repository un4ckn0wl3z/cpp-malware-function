// CreateRemoteThread_Test.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#include "InjectDll.h"
#include "AdjustTokenPrivileges.h"
#define MAX_LENGTH 999

int _tmain(int argc, _TCHAR* argv[])
{

	EnbalePrivileges(::GetCurrentProcess(), SE_DEBUG_NAME);

	DWORD pid = 0;
	char x86DllPath[MAX_PATH] = "C:\\Users\\anuwat\\Documents\\Visual Studio 2013\\Projects\\CreateRemoteThread_Test\\Debug\\DllTest.dll";
	char x64DllPath[MAX_PATH] = "C:\\Users\\anuwat\\Documents\\Visual Studio 2013\\Projects\\CreateRemoteThread_Test\\x64\\Debug\\DllTest.dll";

	std::cout << "Enter PID: "; 
	std::cin >> pid;




#ifndef _WIN64
	BOOL bRet = CreateRemoteThreadInjectDll(pid, x86DllPath);
#else 
	BOOL bRet = CreateRemoteThreadInjectDll(pid, x64DllPath);
#endif

	if (FALSE == bRet)
	{
		printf("Inject Dll Error.\n");
	}
	printf("Inject Dll OK.\n");
	system("pause");
	return 0;
}

